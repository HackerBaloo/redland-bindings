--- redland_wrap.c.orig	2005-05-05 21:54:03.000000000 +0100
+++ redland_wrap.c	2005-05-05 21:54:17.000000000 +0100
@@ -680,7 +680,7 @@
   p = value->ptr;
   if (type==-1) return -1;
 
-  type_name=zend_rsrc_list_get_rsrc_type(z->value.lval);
+  type_name=zend_rsrc_list_get_rsrc_type(z->value.lval TSRMLS_CC);
 
   return SWIG_ZTS_ConvertResourceData(p,type,type_name,ptr,ty TSRMLS_CC);
 }
@@ -2035,7 +2035,8 @@
     }
     
     result = (char *)librdf_node_get_literal_value(arg1);
-    
+    if(!result)
+      result="";
     
     if(!result) {
         ZVAL_NULL(return_value);
@@ -2066,6 +2067,8 @@
     }
     
     result = (char *)librdf_node_get_literal_value_as_latin1(arg1);
+    if(!result)
+      result="";
     
     
     if(!result) {
@@ -2097,6 +2100,8 @@
     }
     
     result = (char *)librdf_node_get_literal_value_language(arg1);
+    if(!result)
+      result="";
     
     
     if(!result) {
@@ -4886,6 +4891,8 @@
     arg2 = (int) Z_LVAL_PP(args[1-argbase]);
     
     result = (librdf_node *)librdf_query_results_get_binding_value(arg1,arg2);
+    if(!result)
+      result="";
     
     
     SWIG_SetPointerZval(return_value, (void *)result, SWIGTYPE_p_librdf_node_s, 0);
@@ -6207,6 +6214,7 @@
 
 PHP_MSHUTDOWN_FUNCTION(redland)
 {
+    librdf_php_world_finish();
     return SUCCESS;
 }
 PHP_MINIT_FUNCTION(redland)
@@ -6275,5 +6283,10 @@
 }
 PHP_MINFO_FUNCTION(redland)
 {
+    php_info_print_table_start();
+    php_info_print_table_header(2, "Redland RDF Support", "enabled");
+    php_info_print_table_row(2, "redland librdf version", librdf_version_string);
+    php_info_print_table_row(2, "redland php bindings version", REDLAND_BINDINGS_VERSION);
+    php_info_print_table_end();
 }
 /* end init section */
